const w=e=>e.replace(/\s/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase(),c=e=>JSON.parse(JSON.stringify(e));function m(){return new Promise(e=>{let n=t=>{let{data:o}=t;!o.action!="frameContext"&&(window.removeEventListener("message",n),e(o))};window.addEventListener("message",n),window.parent.postMessage({action:"sendFrameContext"},"*")})}function u(e){const n="requestSourceData";return new Promise(t=>{let o=s=>{let{data:a}=s;!a.action!=n&&(window.removeEventListener("message",o),t(a.sources))};window.addEventListener("message",o),window.parent.postMessage({action:n,topic:e},"*")})}async function p(){let e=[],n=await u("assets");for(let t of n){let o=t.panel.site,s=t.panel.slug,a=t.panel.itemId;for(let r of Object.keys(t.assetsData))for(let i of Object.keys(t.assetsData[r]))for(let d of t.assetsData[r][i]){i=i.startsWith("//")?i:`//${o}${i}`;let l=`${i}/${r}/${d}`,f={site:o,slug:s,item:a,dir:r,path:i,file:d,url:l};e.push(f)}}return e}function g(){return new Promise((e,n)=>{window.addEventListener("message",t);function t({data:o}){o.action=="neighborhood"&&(window.removeEventListener("message",t),e(o.neighborhood))}window.parent.postMessage({action:"requestNeighborhood"},"*")})}function h(e,n=!1){const t={action:"doInternalLink",keepLineup:n};typeof e=="object"?Object.assign(t,e):Object.assign(t,{title:e}),window.parent.postMessage(t,"*")}function b(e,n=!1,t=[]){let o=Date.now();for(let a of e.story)a.id||=(Math.random()*10**20).toFixed(0);e.journal||=[{type:"create",date:o,item:c(e)},...t.map(a=>({type:"fork",date:o,site:a}))];let s={action:"showResult",page:e,keepLineup:n};window.parent.postMessage(s,"*")}function y(e,n=!1,t=[]){let o=Date.now();for(let a of Object.values(e)){for(let r of a.story)r.id||=(Math.random()*10**20).toFixed(0);a.journal||=[{type:"create",date:o,item:c(a)},...t.map(r=>({type:"fork",date:o,site:r}))]}let s={action:"importer",pages:e,keepLineup:n};window.parent.postMessage(s,"*")}function v(e,n,t="text/json"){var o=`data:${t};charset=utf-8,`+encodeURIComponent(e),s=document.createElement("a");s.setAttribute("href",o),s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove()}function j(){window.parent.postMessage({action:"resize",height:document.body.offsetHeight+5},"*")}export{c as asCopy,w as asSlug,p as assets,m as context,v as download,y as importer,h as link,g as neighbors,b as open,j as resize,u as sources};
